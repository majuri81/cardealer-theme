!function($){"use strict";$.fn.exists=function(){return 0<this.length};var parentjQuery=window.parent.jQuery.noConflict();function is_iframe(){return window.self!==window.top}function cardealer_trigger(event,data){null==data?$(document).trigger(event):$(document).trigger(event,data),is_iframe()&&(null==data?(parentjQuery("body").trigger(event),$(document).trigger(event)):parentjQuery("body").trigger(event,data))}$(document).ready(function($){$(document).on("click",".vehicle-button-link.car-buy-online-btn.car-buy-online-btn-iframe",function(e){e.preventDefault(e);e=$(this);(is_iframe()?parentjQuery("body"):$(document)).trigger("cardealer-vehicle-button-buy-online",e)}),$(document).on("click",".cardealer-lead-form-req-price-btn.cardealer-lead-form-req-price-btn-iframe",function(e){e.preventDefault(e),top.location.href=$(this).attr("href")}),$(document).on("click",".cd-vehicle-compare-wrapper .cd-vehicle-compare table td .compare-image-link, .cd-vehicle-compare-wrapper .cd-vehicle-compare table th .compare-title-link",function(e){e.preventDefault(e),top.location.href=$(this).attr("href")});var compare_modal_iframe,compare_menu_item=$(".menu-item.menu-item-compare"),compare_wrapper=$(".cd-vehicle-compare-wrapper"),compare_table=(compare_wrapper.find(".cd-vehicle-compare"),compare_wrapper.find(".cd-vehicle-compare-table")),compare_vehicle_ids=new Array,compare_vehicle_ids_count=0,compare_modal_el=$("#cd-vehicle-compare-modal"),compare_content=(compare_modal_el.find(".modal-body"),compare_modal_el.find(".cd-vehicle-compare-content")),compare_loader=compare_modal_el.find(".cd-vehicle-compare-loader");function update_vehicle_compare_data(){var compare_vehicle_ids_cookie;compare_vehicle_ids_cookie=cookies.get("compare_ids"),compare_vehicle_ids=null===compare_vehicle_ids_cookie||""===compare_vehicle_ids_cookie?new Array:compare_vehicle_ids_cookie,compare_vehicle_ids_count=get_compare_vehicle_ids_count,compare_table.attr("data-vehicle_count",compare_vehicle_ids_count),generate_compare_url(compare_vehicle_ids)}function update_compare_menu(){null!==cardealer_compare_obj.compare_url&&0<(compare_vehicle_ids_count=get_compare_vehicle_ids_count())?(compare_menu_item.show(),$(".menu-item .compare-details.count").html(compare_vehicle_ids.length)):compare_menu_item.hide()}function get_compare_vehicle_ids_count(){return null===compare_vehicle_ids||""===compare_vehicle_ids?0:compare_vehicle_ids.length}function searchNumberInArray(value){for(var i=0;i<compare_vehicle_ids.length;i++){if("number"==typeof compare_vehicle_ids[i]&&compare_vehicle_ids[i]===value)return i;if("string"==typeof compare_vehicle_ids[i]){var parsedNumber=parseInt(compare_vehicle_ids[i]);if(!isNaN(parsedNumber)&&parsedNumber===value)return i}}return!1}function generate_compare_url(car_ids){var current_url,new_current_url;null!==cardealer_compare_obj.compare_url&&(current_url=new URL(cardealer_compare_obj.compare_url),new_current_url=cardealer_compare_obj.compare_url,current_url.searchParams.set("car_ids","car_ids_placeholder"),new_current_url=current_url.toString().replace("car_ids_placeholder",car_ids.join(",")),cardealer_compare_obj.compare_url=new_current_url,cardealer_compare_obj.compare_url)}compare_menu_item.hide(),update_vehicle_compare_data(),update_compare_menu(),$(document).on("update_compare_menu",function(){update_compare_menu()}),$(document).on("update_vehicle_compare_data",function(){update_vehicle_compare_data()}),$(document).on("click",".compare_pgs, .menu-item-compare",function(){cardealer_trigger("update_vehicle_compare_data");var car_id;$(this).hasClass("compare_pgs")&&(car_id=parseInt($(this).data("id")),$(this).find("i").removeClass("fa-exchange-alt"),$(this).find("i").addClass("fa-check"),(0===(compare_vehicle_ids_count=get_compare_vehicle_ids_count())||0<compare_vehicle_ids_count&&-1===$.inArray(car_id,compare_vehicle_ids))&&compare_vehicle_ids.push(car_id),cookies.del("compare_ids"),cookies.set("compare_ids",JSON.stringify(compare_vehicle_ids)),cardealer_trigger("update_vehicle_compare_data"),cardealer_trigger("update_compare_menu")),generate_compare_url(compare_vehicle_ids),(compare_modal_iframe=$("<iframe>")).css("opacity","0"),compare_modal_iframe.css("width","100%"),compare_modal_iframe.css("height","100%"),compare_modal_iframe.attr("class","cd-vehicle-compare-iframe"),compare_modal_iframe.attr("frameborder","0"),compare_modal_iframe.attr("src",cardealer_compare_obj.compare_url),compare_modal_iframe.on("load",function(){compare_loader.css("display","none"),compare_modal_iframe.css("opacity","1")}),compare_content.html(compare_modal_iframe),compare_modal_iframe.on("reload",function(){alert("loading iframe"),this.contentWindow.location.reload()}),"template"==cardealer_compare_obj.compare_type?window.location.href=cardealer_compare_obj.compare_url:compare_modal_el.modal("show")}),compare_modal_el.on("shown.bs.modal",function(e){compare_loader.css("display","block")}),compare_modal_el.on("hide.bs.modal",function(e){}),compare_modal_el.on("hidden.bs.modal",function(e){compare_modal_el.find(".cd-vehicle-compare-iframe").remove(),compare_loader.css("display","block")}),jQuery(document).on("hidden.bs.modal","#cd-vehicle-compare-modal",function(e){$(".compare_pgs i.fa-spinner").parent().addClass("compared_pgs")}),$(document).on("click",".vehicle-column .compare-remove-column",function(){var car_id=$(this).data("car_id"),column_class=$(this).data("column_class"),column_class=$(column_class);cardealer_trigger("update_vehicle_compare_data"),column_class.remove(),cardealer_trigger("remove_compare_vehicle_ids",car_id),cookies.del("compare_ids"),cookies.set("compare_ids",JSON.stringify(compare_vehicle_ids)),cardealer_trigger("update_vehicle_compare_data"),cardealer_trigger("update_compare_menu"),generate_compare_url(compare_vehicle_ids),window.history.replaceState({},"Page",cardealer_compare_obj.compare_url)}),$(".cd-compare-select-wrapper").exists()&&$(".cd-compare-select-wrapper").each(function(){var compare_select_wrapper=$(this),compare_select_attr=compare_select_wrapper.find(".cd-compare-select.cd-compare-select-attr"),compare_select_cntr_attr=compare_select_wrapper.find(".cd-compare-select-field-container-attr"),compare_select_vehicle=compare_select_wrapper.find(".cd-compare-select.cd-compare-select-vehicle"),compare_select_wrapper=compare_select_wrapper.find(".cd-compare-select-field-container-vehicle"),compare_select_vehicle_select2=(compare_select_attr.select2({id:"-1",allowClear:!0,dropdownCssClass:"cd-compare-select-attr-dropdown",dropdownParent:compare_select_cntr_attr}),compare_select_vehicle.select2({id:"-1",allowClear:!0,dropdownCssClass:"cd-compare-select-vehicle-dropdown",dropdownParent:compare_select_wrapper}));$(compare_select_attr).on("change",function(){var $el=$(this),field_attr=$(this).data("field_attr");$el.val();$.ajax({url:cardealer_compare_obj.ajaxurl,type:"post",data:{action:"cardealer_get_compare_cars",compare_nonce:cardealer_compare_obj.compare_nonce,field_attr:field_attr,field_attr_val:$(this).val(),ppp:cardealer_compare_obj.select_vehicles_ppp},beforeSend:function(){compare_select_vehicle_select2.data("select2").$container.addClass("cd-loading")},complete(xhr,status){compare_select_vehicle_select2.data("select2").$container.removeClass("cd-loading")},success:function(response){var option;compare_select_vehicle.empty(),response.hasOwnProperty("items")&&0<response.items.length&&(option=new Option("",""),compare_select_vehicle.append(option),response.items.forEach(function(obj){obj=new Option(obj.title,obj.id);compare_select_vehicle.append(obj)}))},error:function(error){alert(cardealer_compare_obj.compare_load_error_msg)}})}),$(compare_select_vehicle).on("change",function(){var car_id=parseInt($(this).val());cardealer_trigger("update_vehicle_compare_data"),cardealer_trigger("add_compare_vehicle_ids",car_id),cookies.del("compare_ids"),cookies.set("compare_ids",JSON.stringify(compare_vehicle_ids)),cardealer_trigger("update_vehicle_compare_data"),cardealer_trigger("update_compare_menu"),generate_compare_url(compare_vehicle_ids),$("body").addClass("cd-vehicle-compare-loading"),window.location.href=cardealer_compare_obj.compare_url})}),$(document).on("remove_compare_vehicle_ids",function(event,data){data=searchNumberInArray(data);!1!==data&&compare_vehicle_ids.splice(data,1)}),$(document).on("add_compare_vehicle_ids",function(event,data){searchNumberInArray(data)||(compare_vehicle_ids.push(data),$(document).trigger("update_compare_menu"))})})}(jQuery);