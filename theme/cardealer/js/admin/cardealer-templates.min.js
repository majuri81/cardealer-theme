!function($){"use strict";$.fn.exists=function(){return 0<this.length},$(".cardealer_templates-actions").exists()&&$(".cardealer_templates-actions").insertAfter("body.post-type-cardealer_template .wrap > .wp-heading-inline").css("display","inline-block");var $new_template_modal_el=$("#cdtmpl-modal"),$new_template_form=$("#cdtmpl-modal-form"),$cdtmpl_close_icon=$("#cdtmpl-modal-close-icon"),$cdtmpl_submit_button=$("#cdtmpl-create-template-button"),$cdtmpl_close_button=$("#cdtmpl-close-button"),builder_type="",template_type="",options_selected=!1,templates={},predefined_templates=wp.template("cardealer_templates--predefined-templates"),predefined_templates_not_found_content=wp.template("cardealer_templates--predefined-template--not-found")({}),predefined_templates_select_option_content=wp.template("cardealer_templates--predefined-template--select-option")({}),predefined_templates_loader_content=wp.template("cardealer_templates--predefined-template--loader")({}),cardealer_templates_modal=new bootstrap.Modal($new_template_modal_el,{keyboard:!1,backdrop:"static"});function update_options(){builder_type=$new_template_modal_el.find("#cdtmpl-builder-type").val(),template_type=$new_template_modal_el.find("#cdtmpl-template-type").val(),templates=null!==builder_type&&""!==builder_type&&null!==template_type&&""!==template_type?(options_selected=!0,function(builder_type,template_type){return cardealer_predefined_templates.filter(function(element,index,array){return element.builder_type==builder_type&&element.template_type==template_type},template_type)}(builder_type,template_type)):(options_selected=!1,{})}function display_loader(){$new_template_modal_el.find(".predefined-templates-wrapper .predefined-templates-content").html(predefined_templates_loader_content)}function display_templates(){var predefined_templates_content=predefined_templates({templates:templates});0<templates.length?($new_template_modal_el.find(".predefined-templates-wrapper .predefined-templates-content").html(predefined_templates_content),$cdtmpl_submit_button.prop("disabled",!1)):(options_selected?$new_template_modal_el.find(".predefined-templates-wrapper .predefined-templates-content").html(predefined_templates_not_found_content):$new_template_modal_el.find(".predefined-templates-wrapper .predefined-templates-content").html(predefined_templates_select_option_content),$cdtmpl_submit_button.prop("disabled",!0))}$new_template_modal_el.on("show.bs.modal, shown.bs.modal",function(event){$(".modal-backdrop").addClass("cardealer-modal-backdrop")}),$new_template_modal_el.on("shown.bs.modal",function(event){display_loader(),update_options(),display_templates()}),$new_template_modal_el.on("hide.bs.modal",function(event){template_type=builder_type="",options_selected=!1}),jQuery(document).on("click",".cardealer_templates-action-new",function(event){event.preventDefault(),cardealer_templates_modal.show()}),jQuery("body").on("click",".predefined-template-label",function(){var label_for=jQuery(this).data("for"),label_for=jQuery("#"+label_for);jQuery(label_for).is(":checked")?jQuery(label_for).prop("checked",!1):jQuery(label_for).prop("checked",!0)}),$new_template_modal_el.on("change","#cdtmpl-builder-type, #cdtmpl-template-type",function(el){display_loader(),update_options(),display_templates()}),$new_template_form.submit(function(event){event.preventDefault(),$cdtmpl_close_icon.prop("disabled",!0),$cdtmpl_close_button.prop("disabled",!0),$cdtmpl_submit_button.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> '+$cdtmpl_submit_button.html()),$(this).unbind("submit").submit()})}(jQuery,window);